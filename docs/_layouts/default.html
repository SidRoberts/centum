<!DOCTYPE html>
<html lang="en">

<head>

    <title>
        {% if page.title %}
            {{ page.title }} | {{ site.name }}
        {% else %}
            {{ site.name }}
        {% endif %}
    </title>

    <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/_assets/styles.css">
    <meta name="darkreader-lock">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <script src="https://kit.fontawesome.com/322f609a86.js" crossorigin="anonymous"></script>

    <script src="{{ site.baseurl }}/_assets/js/Dialog.js"></script>

</head>

<body>
    <a href="#content" class="skip-to-content">
        <span class="fa-solid fa-chevron-down fa-fw"></span>
        <span class="text">Skip to content</span>
        <span class="fa-solid fa-chevron-down fa-fw"></span>
    </a>

    <header>
        <nav>
            <div class="nav-branding">
                <a href="{{ site.baseurl }}/" class="brand">
                    {{ site.name }}
                </a>

                <div class="permalink">
                    <a href="{{ site.baseurl }}{{ page.url | absolute_url }}">{{ page.url | absolute_url }}</a>
                </div>

                <a href="#" class="nav-toggle" data-open-dialog="#menuDialog">
                    <span class="fa-solid fa-bars fa-fw"></span>

                    <span class="visually-hidden">Toggle nav</span>
                </a>
            </div>

            <dialog class="offcanvas end" id="menuDialog">
                <div class="header">
                    <div class="title">
                        Navigation
                    </div>

                    <form method="dialog" class="dismiss">
                        <button>
                            <span class="fa-solid fa-remove fa-fw"></span>
                        </button>
                    </form>
                </div>

                <div class="content">

                    {%- assign candidates = site.pages
                        | where_exp: "item", "item.title != nil"
                        | where_exp: "item", "item.nav_exclude != true"
                        | where_exp: "item", "item.parent == nil"
                        | where_exp: "item", "item.has_children != true" -%}

                    {%- include nav-sorter.html candidates=candidates -%}
                    {%- assign top_level_pages_without_children = __return -%}

                    <menu class="nav-links">
                        {% for nav_page in top_level_pages_without_children %}
                            <li class="nav-link">
                                <a href="{{ site.baseurl }}{{ nav_page.url }}" {% if page.url == nav_page.url %}class="active"{% endif %}>
                                    <span class="nav-title">{{ nav_page.title }}</span>
                                </a>
                            </li>
                        {% endfor %}
                    </menu>



                    {%- assign candidates = site.pages
                        | where_exp: "item", "item.title != nil"
                        | where_exp: "item", "item.nav_exclude != true"
                        | where_exp: "item", "item.parent == nil"
                        | where_exp: "item", "item.has_children == true" -%}

                    {%- include nav-sorter.html candidates=candidates -%}
                    {%- assign organised_pages = __return -%}

                    {%- include nav-links.html nav_pages=organised_pages -%}
                </div>
            </dialog>
        </nav>
    </header>

    <main>
        <article id="content">
            {{ content }}

            {%- include page-navigation.html -%}
        </article>
    </main>

    <footer>
        <div class="nav-links">
            <menu class="nav-links-start">
                <div class="copyright">
                    <span class="fa-solid fa-copyright fa-fw" aria-label="Copyright"></span>

                    {{ site.copyright }}
                </div>
            </menu>

            {% if site.gh_repository %}
                <menu class="nav-links-end" role="navigation">
                    {% if site.gh_branch and site.gh_edit_view_mode %}
                        <li class="nav-link">
                            <a href="https://github.com/{{ site.gh_repository }}/{{ site.gh_edit_view_mode }}/{{ site.gh_branch }}{% if site.gh_dir %}/{{ site.gh_dir }}{% endif %}/{{ page.path }}">
                                <span class="fa-solid fa-edit fa-fw"></span>

                                Edit on GitHub
                            </a>
                        </li>
                    {% endif %}

                    <li class="nav-link">
                        <a href="https://github.com/{{ site.gh_repository }}">
                            <span class="fa-brands fa-github fa-fw"></span>

                            <span class="visually-hidden">GitHub repository</span>
                        </a>
                    </li>
                </menu>
            {% endif %}
        </div>
    </footer>

</body>

</html>
